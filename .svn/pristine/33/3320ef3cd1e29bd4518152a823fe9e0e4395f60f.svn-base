import React from 'react'
import PropTypes from 'prop-types'
import ProductCard from '../product-card';
import Grid from '@mui/material/Grid';

const CatalogGrid = ({catalog, filterProductInputValue, comboSelectedHandler, productSelectedHandler, comboColor, productColor, categoriesSelected }) => {

    const isCategoryIncluded = (item) => {
        let categoryName = item.categoryName
        if (!categoryName){
            if (item.combo) categoryName = 'Combos'
            else categoryName = 'Productos'
        }
        const categoriesSelectedEntries = Object.entries(categoriesSelected)
        if (!categoriesSelectedEntries.some(entry => entry[1] === true)) return true
        if (categoriesSelected[categoryName]) return true
        return false
    }

    return <Grid container spacing={2}>
                {catalog?.filter((item) => {
                    if (!item.name.toLowerCase().includes(filterProductInputValue.toLowerCase())) return false
                    if (isCategoryIncluded(item)) return true
                    return false
                    }).map((item) => <Grid style={{marginBottom: '2px'}}  key={item.id} item sm={6} lg={3}>
                    <ProductCard onClickHandler={() => item.combo ? comboSelectedHandler(item) : productSelectedHandler(item)} 
                        rectangleColor= {!item.categoryColor ? item.combo ?  comboColor : productColor  : item.categoryColor} label= {item.combo?  'Combo' : ''} 
                        title={item.name} price={`RD$ ${item.price}`}/>
                </Grid> )}
        </Grid>
}

CatalogGrid.propTypes = {
    catalog: PropTypes.array,
    filterProductInputValue: PropTypes.string,
    isCombosSelected: PropTypes.bool,
    comboSelectedHandler: PropTypes.func,
    productSelectedHandler: PropTypes.func,
    comboColor: PropTypes.string,
    productColor: PropTypes.string,
    categoriesSelected: PropTypes.object
}

export default CatalogGrid